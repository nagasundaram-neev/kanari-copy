'use strict';

/* App Module */

var module = angular.module('kanari', []).
  config(['$routeProvider','$locationProvider', function($routeProvider,$locationProvider) {
  	
  $routeProvider.
     when('/login', {templateUrl: "<%= asset_path 'login.html' %>"}).
     when('/forgot_pass', {templateUrl: "<%= asset_path 'forgot_password.html' %>"}).
     when('/api/users/password/edit', {templateUrl: "<%= asset_path 'reset_password.html' %>"}).
     when('/outlets', {templateUrl: "<%= asset_path 'home.html' %>"}).
     when('/createInvitation', {templateUrl: "<%= asset_path 'add_Restaurant.html' %>"}).
     when('/accept_invitation', {templateUrl: "<%= asset_path 'accept_invitation.html' %>"}).
     when('/acceptInvitationStep2', {templateUrl: "<%= asset_path 'accept_invitation_step2.html' %>"}).
     when('/create_outlet', {templateUrl: "<%= asset_path 'create_outlet.html' %>"}).
     when('/create_manager', {templateUrl: "<%= asset_path 'create_manager.html' %>"}).
     when('/list_payment_invoice',{templateUrl:"<%= asset_path 'list_payment_invoice.html'%>"}).
     when('/payment_invoice',{templateUrl:"<%= asset_path 'payment_invoice.html'%>"}).
      when('/take_tour',{templateUrl:"<%= asset_path 'takeTour.html'%>"}).
       when('/view_account',{templateUrl:"<%= asset_path 'viewAccount.html'%>"}).
     when('/logout', {templateUrl: "<%= asset_path 'logOut.html' %>"}).
      otherwise({redirectTo: '/login'});
      $locationProvider.hashPrefix = "";
}]);

module.directive('map', function() {
    return {
        restrict: 'E',
        replace: true,
        template: '<div></div>',
        link: function(scope, element, attrs) {
            console.log(element);
            
            var myOptions = {
                zoom: 6,
                center: new google.maps.LatLng(46.87916, -3.32910),
                mapTypeId: google.maps.MapTypeId.ROADMAP
            };
           // alert(attrs.id);
            var map = new google.maps.Map(document.getElementById(attrs.id), myOptions);
            
            google.maps.event.addListener(map, 'click', function(e) {
                scope.$apply(function() {
                    addMarker({
                    lat: e.latLng.lat(),
                    lng: e.latLng.lng()
                  }); 
                    
                    console.log(e);
                });
    
            }); // end click listener
            
            var addMarker= function(pos){
            	alert('in');
               var myLatlng = new google.maps.LatLng(pos.lat,pos.lng);
               var marker = new google.maps.Marker({
                    position: myLatlng, 
                    map: map,
                    title:"Hello World!"
                });
            } //end addMarker
            
        }
    };
});

function MapCtrl($scope) {
        
    $scope.mapPin = 'No pin set yet';       
          
}